<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Factored Regression Model: Generalized Linear Regression Model with Missing Covariates — frm • mdmb</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Factored Regression Model: Generalized Linear Regression Model with Missing Covariates — frm" />
<meta property="og:description" content="The factored regression model (FRM) allows the estimation of the linear regression model
(with normally distributed residuals) and the generalized logistic regression model
(logistic regression for dichotomous outcomes). Missing values in covariates are
handled by posing a conditional univariate distribution for each covariate. The
approach follows Ibrahim (1990), Ibrahim, Chen, Lipsitz and Herring (2005),
Lee and Mitra (2016), and Zhang and Wang (2017) and is applied in
Luedtke, Robitzsch, and West (XXXX, XXXX). Latent variables
and covariates with measurement error or multiple indicators can also be handled
within this framework (see Examples 3, 4 and 5).
Missing values are handled by numerical integration in frm_em
(see also Allison, 2012). The user has to specify an integration grid for each
variable (defined in argument nodes for each model).
Standard error estimates in frm_em are obtained by a numerical differentiation of
the Fisher score function (see Jamshidian &amp;amp; Jennrich, 2000).
The function frm_fb employs a fully Bayesian approach with noninformative
prior distribution. This function imputes missing values in the models from
the posterior distributions. Imputed datasets can be extracted by the
function frm2datlist.
The current functionality only support missing values on continuous covariates
(accommodating skewness and only positive values), dichotomous covariates and
ordinal covariates.
Multilevel models (using model=&quot;mlreg&quot;) for normally distributed
(outcome=&quot;normal&quot;) and ordinal variables (outcome=&quot;probit&quot;)
as well as variables at higher levels (using argument variable_level)
are accommodated.
The handling of nominal covariates will be included in future
mdmb package versions." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mdmb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Versions">1.5-vv</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexanderrobitzsch/mdmb/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Factored Regression Model: Generalized Linear Regression Model with Missing Covariates</h1>
    
    <div class="hidden name"><code>frm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The factored regression model (FRM) allows the estimation of the linear regression model
(with normally distributed residuals) and the generalized logistic regression model
(logistic regression for dichotomous outcomes). Missing values in covariates are
handled by posing a conditional univariate distribution for each covariate. The
approach follows Ibrahim (1990), Ibrahim, Chen, Lipsitz and Herring (2005),
Lee and Mitra (2016), and Zhang and Wang (2017) and is applied in
Luedtke, Robitzsch, and West (XXXX, XXXX). Latent variables
and covariates with measurement error or multiple indicators can also be handled
within this framework (see Examples 3, 4 and 5).</p>
<p>Missing values are handled by numerical integration in <code>frm_em</code>
(see also Allison, 2012). The user has to specify an integration grid for each
variable (defined in argument <code>nodes</code> for each model).</p>
<p>Standard error estimates in <code>frm_em</code> are obtained by a numerical differentiation of
the Fisher score function (see Jamshidian &amp; Jennrich, 2000).</p>
<p>The function <code>frm_fb</code> employs a fully Bayesian approach with noninformative
prior distribution. This function imputes missing values in the models from
the posterior distributions. Imputed datasets can be extracted by the
function <code>frm2datlist</code>.</p>
<p>The current functionality only support missing values on continuous covariates
(accommodating skewness and only positive values), dichotomous covariates and
ordinal covariates.</p>
<p>Multilevel models (using <code>model="mlreg"</code>) for normally distributed
(<code>outcome="normal"</code>) and ordinal variables (<code>outcome="probit"</code>)
as well as variables at higher levels (using argument <code>variable_level</code>)
are accommodated.</p>
<p>The handling of nominal covariates will be included in future
<span class="pkg">mdmb</span> package versions.</p>
    </div>

    <pre class="usage"><span class='co'># Factored regression model: Numerical integration with EM algorithm</span>
<span class='fu'>frm_em</span>(<span class='no'>dat</span>, <span class='no'>dep</span>, <span class='no'>ind</span>, <span class='kw'>weights</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>maxiter</span><span class='kw'>=</span><span class='fl'>500</span>, <span class='kw'>conv_dev</span><span class='kw'>=</span><span class='fl'>1e-08</span>,
         <span class='kw'>conv_parm</span><span class='kw'>=</span><span class='fl'>1e-05</span>, <span class='kw'>nodes_control</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>11</span>,<span class='fl'>5</span>), <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>1e-04</span>, <span class='kw'>use_grad</span><span class='kw'>=</span><span class='fl'>2</span>)

<span class='co'># S3 method for frm_em</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for frm_em</span>
<span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for frm_em</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>, <span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>file</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)
<span class='co'># S3 method for frm_em</span>
<span class='fu'><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># Factored regression model: Fully Bayesian estimation</span>
<span class='fu'>frm_fb</span>(<span class='no'>dat</span>, <span class='no'>dep</span>, <span class='no'>ind</span>, <span class='kw'>weights</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>data_init</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='fl'>500</span>,
        <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>Nimp</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>Nsave</span><span class='kw'>=</span><span class='fl'>3000</span>, <span class='kw'>refresh</span><span class='kw'>=</span><span class='fl'>25</span>, <span class='kw'>acc_bounds</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.45</span>,<span class='fl'>.50</span>),
        <span class='kw'>print_iter</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>use_gibbs</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>aggregation</span><span class='kw'>=</span><span class='fl'>TRUE</span>)

<span class='co'># S3 method for frm_fb</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for frm_fb</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>idparm</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>ask</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='no'>...</span> )
<span class='co'># S3 method for frm_fb</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>, <span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>file</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)
<span class='co'># S3 method for frm_fb</span>
<span class='fu'><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='fu'>frm2datlist</span>(<span class='no'>object</span>, <span class='kw'>as_mids</span><span class='kw'>=</span><span class='fl'>FALSE</span>)  <span class='co'># create list of imputed datasets</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>Data frame</p></td>
    </tr>
    <tr>
      <th>dep</th>
      <td><p>List containing model specification for dependent variable. The list
has arguments (see Examples)</p>
<p><code>model</code>: String indicating the model type. Options are
<code>"linreg"</code> (wrapper to <code><a href='https://rdrr.io/r/stats/lm.html'>stats::lm</a></code>
or <code><a href='https://rdrr.io/r/stats/lmfit.html'>stats::lm.wfit</a></code>),
<code>"logistic"</code> for dichotomous variables (wrapper to <code><a href='mdmb_regression.html'>logistic_regression</a></code>),
<code>"oprobit"</code> for ordinal variables
(wrapper to <code><a href='mdmb_regression.html'>oprobit_regression</a></code>),
<code>"yjtreg"</code> for continuous variables and bounded variables on \((0,1)\)
(wrapper to <code><a href='mdmb_regression.html'>yjt_regression</a></code>),
<code>"bctreg"</code> for positive continuous variables
(wrapper to <code><a href='mdmb_regression.html'>bct_regression</a></code>),
<code>"mlreg"</code> for multilevel models with normally distributed and ordinal
data (wrapper to <code><a href='https://rdrr.io/pkg/miceadds/man/ml_mcmc.html'>miceadds::ml_mcmc</a></code>)
 <br />
<code>formula</code>: An <span style="R">R</span> formula object. <br />
<code>nodes</code> (for <code>frm_em</code>): Vector containing the integration nodes <br />
<code>nodes_weights</code> (for <code>frm_em</code>):
Optional vector containing initial probabilities for each node <br />
<code>coef_inits</code>: Optional vector containing initial coefficient for the model <br />
<code>sigma_fixed</code>: Fixed standard deviations in case of <code>model="linreg"</code>.
Heterogeneous standard deviations are allowed. <br />
<code>R_args</code>: Arguments for estimation functions. <br />
<code>sampling_level</code>: Variable name for cluster identifiers for level for sampling values
for multilevel data. Sampling at level of clusters can be beneficials
if derived variables from cluster members (e.g., group means) occur
in multilevel models. The option is only applicable for <code>frm_fb</code>. <br />
<code>variable_level</code>: Cluster identifier indicating level of variable for imputations
of higher-level variables</p></td>
    </tr>
    <tr>
      <th>ind</th>
      <td><p>List containing a list of univariate conditional models for covariates.
See <code>dep</code> for more details on specification.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Optional vector of sampling weights</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical indicating whether convergence progress should be displayed.</p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>Maximum number of iterations</p></td>
    </tr>
    <tr>
      <th>conv_dev</th>
      <td><p>Convergence criterion for deviance</p></td>
    </tr>
    <tr>
      <th>conv_parm</th>
      <td><p>Convergence criterion for regression coefficients</p></td>
    </tr>
    <tr>
      <th>nodes_control</th>
      <td><p>Control arguments if nodes are not provided
by the user. The first value denote the number of nodes, while
the second value denotes the spread of the node distribution defined
as the factor of the standard deviation of the observed data.</p></td>
    </tr>
    <tr>
      <th>h</th>
      <td><p>Step width for numerical differentiation for calculating the
covariance matrix</p></td>
    </tr>
    <tr>
      <th>use_grad</th>
      <td><p>Computation method for gradient in <code><a href='mdmb_regression.html'>yjt_regression</a></code>,
    <code><a href='mdmb_regression.html'>bct_regression</a></code> or <code><a href='mdmb_regression.html'>logistic_regression</a></code>.
    It can be <code>0</code> (compatible with <span class="pkg">mdmb</span> \(\le\)0.3),
<code>1</code> or <code>2</code> (most efficient one).</p></td>
    </tr>
    <tr>
      <th>data_init</th>
      <td><p>Initial values for dataset</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>Number of iterations</p></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>Number of burnin iterations</p></td>
    </tr>
    <tr>
      <th>Nimp</th>
      <td><p>Number of imputed datasets</p></td>
    </tr>
    <tr>
      <th>Nsave</th>
      <td><p>(Maximum) Number of values to be saved for MCMC chain</p></td>
    </tr>
    <tr>
      <th>refresh</th>
      <td><p>Number of imputations after which proposal distribution
should be updated in Metropolis-Hastings step</p></td>
    </tr>
    <tr>
      <th>acc_bounds</th>
      <td><p>Bounds for acceptance rates for parameters</p></td>
    </tr>
    <tr>
      <th>print_iter</th>
      <td><p>Number of imputation after which iteration progress
should be displayed</p></td>
    </tr>
    <tr>
      <th>use_gibbs</th>
      <td><p>Logical indicating whether Gibbs sampling instead of
    Metropolis-Hastings sampling should be used. Can be only
applied for <code>linreg</code>.</p></td>
    </tr>
    <tr>
      <th>aggregation</th>
      <td><p>Logical indicating whether complete dataset should be
used for computing the predictive distribution of missing values.
<code>argument=TRUE</code> is often needed for multilevel data in which cluster
means are included in regression models.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>Object of corresponding class</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Object of corresponding class</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>Number of digits in <code>summary</code></p></td>
    </tr>
    <tr>
      <th>file</th>
      <td><p>File to which the <code>summary</code> should be linked</p></td>
    </tr>
    <tr>
      <th>idparm</th>
      <td><p>Indices for parameters to be plotted</p></td>
    </tr>
    <tr>
      <th>ask</th>
      <td><p>Logical indicating whether the user is asked before new plot</p></td>
    </tr>
    <tr>
      <th>as_mids</th>
      <td><p>Logical indicating whether multiply imputed datasets
should be converted into objects of class <code>mids</code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function allows for fitting a factored regression model. Consider the case
of three variables \(Y\), \(X\) and \(Z\). A factored regression model
consists of a sequence of univariate conditional models \(P(Y|X,Z)\),
\(P(X|Z)\) and \(P(Z)\) such that the joint distribution can be factorized as
$$ P(Y,X,Z)=P( Y|X,Z) P(X|Z) P(Z) $$
Each of the three variables can contain missing values. Missing values are
integrated out by posing a distributional assumption for each variable with
missing values.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For <code>frm_em</code> it is a list containing the following values</p>
<dt>coefs</dt><dd><p>Estimated coefficients</p></dd>
<dt>vcov</dt><dd><p>Covariance matrix</p></dd>
<dt>partable</dt><dd><p>Summary parameter table</p></dd>
<dt>all_coefs</dt><dd><p>List with all estimated coefficients</p></dd>
<dt>ll</dt><dd><p>Log likelihood value</p></dd>
<dt>like</dt><dd><p>Individual likelihood</p></dd>
<dt>dat</dt><dd><p>Data frame with included latent values for each variable with missing
 values</p></dd>
<dt>se</dt><dd><p>Standard errors for coefficients</p></dd>
<dt>info</dt><dd><p>Information matrix</p></dd>
<dt>conv</dt><dd><p>Convergence indicator</p></dd>
<dt>iter</dt><dd><p>Number of iterations</p></dd>
<dt>ic</dt><dd><p>Information criteria</p></dd>
<dt>ind0</dt><dd><p>List with model specifications including <code>dep</code> and <code>ind</code></p></dd>
<dt>predictorMatrix</dt><dd><p>Predictor matrix</p></dd>
<dt>variablesMatrix</dt><dd><p>Matrix containing all variables appearing in statistical
models</p></dd>
<dt>desc_vars</dt><dd><p>Descriptive statistics of variables</p></dd>
<dt>model_results</dt><dd><p>Results from fitted models</p></dd>

The output for frm_fb contains particular additional values
<dt>tech_summary</dt><dd><p>Summary table with informations about MCMC algorithm</p></dd>
<dt>values_coda</dt><dd><p>Sampled parameter values saved as class <code>mcmc</code> for
analysis in <span class="pkg">coda</span> package</p></dd>
<dt>parms_mcmc</dt><dd><p>Object containing informations of sampled parameters</p></dd>
<dt>imputations_mcmc</dt><dd><p>Object containing informations of imputed datasets</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Allison, P. D. (2012). <em>Handling missing data by maximum likelihood</em>.
SAS Global Forum 2012.</p>
<p>Bartlett, J. W., &amp; Morris, T. P. (2015) Multiple imputation of covariates by
substantive-model compatible fully conditional specification.
<em>Stata Journal, 15</em>(2), 437-456.</p>
<p>Bartlett, J. W., Seaman, S. R., White, I. R., Carpenter, J. R., &amp; Alzheimer's Disease
Neuroimaging Initiative (2015). Multiple imputation of covariates by fully conditional
specification: Accommodating the substantive model.
<em>Statistical Methods in Medical Research, 24</em>(4), 462-487.
doi: <a href='https://doi.org/10.1177/0962280214521348'>10.1177/0962280214521348</a></p>
<p>Erler, N. S., Rizopoulos, D., Rosmalen, J. V., Jaddoe, V. W., Franco, O. H., &amp; Lesaffre, E. M.
(2016). Dealing with missing covariates in epidemiologic studies: A comparison between multiple
imputation and a full Bayesian approach. <em>Statistics in Medicine, 35</em>(17), 2955-2974.
doi: <a href='https://doi.org/10.1002/sim.6944'>10.1002/sim.6944</a></p>
<p>Ibrahim, J. G. (1990). Incomplete data in generalized linear models.
<em>Journal of the American Statistical Association, 85</em>(411), 765-769.
doi: <a href='https://doi.org/10.1080/01621459.1990.10474938'>10.1080/01621459.1990.10474938</a></p>
<p>Ibrahim, J. G., Chen, M. H., Lipsitz, S. R., &amp; Herring, A. H. (2005).
Missing-data methods for generalized linear models: A comparative review.
<em>Journal of the American Statistical Association, 100</em>(469), 332-346.
doi: <a href='https://doi.org/10.1198/016214504000001844'>10.1198/016214504000001844</a></p>
<p>Jamshidian, M., &amp; Jennrich, R. I. (2000). Standard errors for EM estimation.
<em>Journal of the Royal Statistical Society (Series B), 62</em>(2), 257-270.
doi: <a href='https://doi.org/10.1111/1467-9868.00230'>10.1111/1467-9868.00230</a></p>
<p>Keller, B. T., &amp; Enders, C. K. (2018). <em>Blimp user's manual</em>. Los Angeles, CA. <br />
<em>http://www.appliedmissingdata.com/multilevel-imputation.html</em></p>
<p>Lee, M. C., &amp; Mitra, R. (2016). Multiply imputing missing values in data sets
with mixed measurement scales using a sequence of generalised linear models.
<em>Computational Statistics &amp; Data Analysis, 95</em>(24), 24-38.
doi: <a href='https://doi.org/10.1016/j.csda.2015.08.004'>10.1016/j.csda.2015.08.004</a></p>
<p>Luedtke, O., Robitzsch, A., &amp; West, S. (XXXX). Regression models involving nonlinear
effects with missing data: A sequential modeling approach using Bayesian estimation.
<em>Psychological Methods, xx</em>(xx), xxx-xxx.
doi: <a href='https://doi.org/10.1037/met0000233'>10.1037/met0000233</a></p>
<p>Luedtke, O., Robitzsch, A., &amp; West, S. (XXXX). Analysis of interactions and nonlinear
effects with missing data: A factored regression modeling approach using maximum
likelihood estimation. <em>Multivariate Behavioral Research, xx</em>(xx), xxx-xxx.
doi: <a href='https://doi.org/10.1080/00273171.2019.1640104'>10.1080/00273171.2019.1640104</a></p>
<p>Zhang, Q., &amp; Wang, L. (2017). Moderation analysis with missing data in the predictors.
<em>Psychological Methods, 22</em>(4), 649-666.
doi: <a href='https://doi.org/10.1037/met0000104'>10.1037/met0000104</a></p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The <code>coef</code> and <code>vcov</code> methods can be used to extract coefficients and
the corresponding covariance matrix, respectively. Standard errors for a fitted
object <code>mod</code> can be extracted by making use of the <span class="pkg">survey</span>
package and the statement <code><a href='https://rdrr.io/pkg/survey/man/SE.html'>survey::SE(mod)</a></code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>See also the <span class="pkg">icdGLM</span> package for estimation of generalized
linear models with incomplete discrete covariates.</p>
<p>The imputation of covariates in substantive models with interactions or nonlinear
terms can be also conducted with the <span class="pkg">JointAI</span> package which is a wrapper
to the JAGS software (see Erler et al., 2016). This package is also based on a sequential
modelling approach.</p>
<p>The <span class="pkg">jomo</span> package also accommodates substantive models (<code><a href='https://rdrr.io/pkg/jomo/man/jomo.lm.html'>jomo::jomo.lm</a></code>)
based on a joint modeling framework.</p>
<p>Substantive model compatible imputation based
on fully conditional specification can be found in the <span class="pkg">smcfcs</span> package
(see Bartlett et al., 2015; Bartlett &amp; Morris, 2015)
or the Blimp stand-alone software (Keller &amp; Enders, 2018).</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 1: Simulated example linear regression with interaction effects</span>
<span class='co'>#############################################################################</span>

<span class='co'># The interaction model stats::lm( Y ~ X + Z + X:Z) is of substantive interest.</span>
<span class='co'># There can be missing values in all variables.</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.mb01</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.mb01</span>$<span class='no'>missing</span>

<span class='co'>#******************************************</span>
<span class='co'># Model 1: ML approach</span>

<span class='co'>#--- specify models</span>

<span class='co'># define integration nodes</span>
<span class='no'>xnodes</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='fl'>11</span>)        <span class='co'># nodes for X</span>
<span class='no'>ynodes</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>10</span>,<span class='fl'>10</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='fl'>13</span>)
  <span class='co'># nodes for Y. These ynodes are not really necessary for this dataset because</span>
  <span class='co'># Y has no missing values.</span>

<span class='co'># define model for dependent variable Y</span>
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>Y</span> ~  <span class='no'>X</span>*<span class='no'>Z</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>ynodes</span> )

<span class='co'># model P(X|Z)</span>
<span class='no'>ind_X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>X</span> ~ <span class='no'>Z</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>xnodes</span> )
<span class='co'># all models for covariates</span>
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"X"</span><span class='kw'>=</span><span class='no'>ind_X</span> )

<span class='co'>#--- estimate model with numerical integration</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_em</span>(<span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>dep</span><span class='kw'>=</span><span class='no'>dep</span>, <span class='kw'>ind</span><span class='kw'>=</span><span class='no'>ind</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'># extract some informations</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>mod1</span>)
<span class='fu'><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></span>(<span class='no'>mod1</span>)
<span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span>(<span class='no'>mod1</span>)

<span class='co'>#******************************************</span>
<span class='co'># Model 2: Fully Bayesian approach / Multiple Imputation</span>

<span class='co'>#--- define models</span>
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>Y</span> ~  <span class='no'>X</span>*<span class='no'>Z</span> )
<span class='no'>ind_X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>X</span> ~ <span class='no'>Z</span>  )
<span class='no'>ind_Z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>Z</span> ~ <span class='fl'>1</span>  )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"X"</span><span class='kw'>=</span><span class='no'>ind_X</span>, <span class='kw'>Z</span><span class='kw'>=</span><span class='no'>ind_Z</span>)

<span class='co'>#--- estimate model</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_fb</span>(<span class='no'>dat</span>, <span class='no'>dep</span>, <span class='no'>ind</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>200</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='fl'>1000</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)
<span class='co'>#* plot parameters</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod2</span>)

<span class='co'>#--- create list of multiply imputed datasets</span>
<span class='no'>datlist</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm2datlist</span>(<span class='no'>mod2</span>)
<span class='co'># convert into object of class mids</span>
<span class='no'>imp2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>miceadds</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/miceadds/man/datalist2mids.html'>datlist2mids</a></span>(<span class='no'>datlist</span>)
<span class='co'># estimate linear model on multiply imputed datasets</span>
<span class='no'>mod2c</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>imp2</span>, <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>( <span class='no'>Y</span> ~ <span class='no'>X</span>*<span class='no'>Z</span> ) )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>( <span class='kw pkg'>mice</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mice/man/pool.html'>pool</a></span>(<span class='no'>mod2c</span>) )

<span class='co'>#******************************************</span>
<span class='co'># Model 3: Multiple imputation in jomo package</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>jomo</span>)

<span class='co'># impute with substantive model containing interaction effects</span>
<span class='no'>formula</span> <span class='kw'>&lt;-</span> <span class='no'>Y</span> ~ <span class='no'>X</span>*<span class='no'>Z</span>
<span class='no'>imp</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>jomo</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/jomo/man/jomo.lm.html'>jomo.lm</a></span>( <span class='kw'>formula</span><span class='kw'>=</span><span class='no'>formula</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>nburn</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>nbetween</span><span class='kw'>=</span><span class='fl'>100</span>)

<span class='co'># convert to object of class mids</span>
<span class='no'>datlist</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>miceadds</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/miceadds/man/jomo2datlist.html'>jomo2mids</a></span>( <span class='no'>imp</span> )
<span class='co'># estimate linear model</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>datlist</span>, <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>( <span class='no'>Y</span> ~ <span class='no'>X</span>*<span class='no'>Z</span> ) )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>( <span class='kw pkg'>mice</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mice/man/pool.html'>pool</a></span>(<span class='no'>mod3</span>) )

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 2: Simulated example logistic regression with interaction effects</span>
<span class='co'>#############################################################################</span>

<span class='co'># Interaction model within a logistic regression Y ~ X + Z + X:Z</span>
<span class='co'># Y and Z are dichotomous variables.</span>

<span class='co'># attach data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.mb02</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.mb02</span>$<span class='no'>missing</span>

<span class='co'>#******************************************</span>
<span class='co'># Model 1: ML approach</span>

<span class='co'>#--- specify model</span>

<span class='co'># define nodes</span>
<span class='no'>xnodes</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='fl'>15</span>)  <span class='co'># X - normally distributed variable</span>
<span class='no'>ynodes</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>)                <span class='co'># Y and Z dichotomous variable</span>

<span class='co'># model P(Y|X,Z) for dependent variable</span>
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"logistic"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>Y</span> ~  <span class='no'>X</span>*<span class='no'>Z</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>ynodes</span> )
<span class='co'># model P(X|Z)</span>
<span class='no'>ind_X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>X</span> ~ <span class='no'>Z</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>xnodes</span> )
<span class='co'># model P(Z)</span>
<span class='no'>ind_Z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"logistic"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>Z</span> ~ <span class='fl'>1</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>ynodes</span> )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(  <span class='st'>"Z"</span><span class='kw'>=</span><span class='no'>ind_Z</span>, <span class='st'>"X"</span><span class='kw'>=</span><span class='no'>ind_X</span> )

<span class='co'>#--- estimate model with numerical integration</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_em</span>(<span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>dep</span><span class='kw'>=</span><span class='no'>dep</span>, <span class='kw'>ind</span><span class='kw'>=</span><span class='no'>ind</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#******************************************</span>
<span class='co'># Model 2: Fully Bayesian approach</span>

<span class='co'>#--- specify model</span>
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"logistic"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>Y</span> ~  <span class='no'>X</span>*<span class='no'>Z</span>  )
<span class='no'>ind_X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>X</span> ~ <span class='no'>Z</span> )
<span class='no'>ind_Z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"logistic"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>Z</span> ~ <span class='fl'>1</span> )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(  <span class='st'>"Z"</span><span class='kw'>=</span><span class='no'>ind_Z</span>, <span class='st'>"X"</span><span class='kw'>=</span><span class='no'>ind_X</span> )

<span class='co'>#--- Bayesian estimation</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_fb</span>(<span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>dep</span><span class='kw'>=</span><span class='no'>dep</span>, <span class='kw'>ind</span><span class='kw'>=</span><span class='no'>ind</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>500</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='fl'>1000</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 3: Confirmatory factor analysis</span>
<span class='co'>#############################################################################</span>

<span class='co'># A latent variable can be considered as missing data and the 'frm_em' function</span>
<span class='co'># is used to estimate the latent variable model.</span>

<span class='co'>#--- simulate data</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>1000</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>91834</span>)
<span class='co'># latent variable</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>)
<span class='co'># simulate items</span>
<span class='no'>y1</span> <span class='kw'>&lt;-</span> <span class='fl'>1.5</span> + <span class='fl'>1</span>*<span class='no'>theta</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>.7</span> )
<span class='no'>y2</span> <span class='kw'>&lt;-</span> <span class='fl'>1.9</span> + <span class='fl'>.7</span>*<span class='no'>theta</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span> )
<span class='no'>y3</span> <span class='kw'>&lt;-</span> <span class='fl'>.9</span> + <span class='fl'>.7</span>*<span class='no'>theta</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>.2</span> )
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='no'>y1</span>,<span class='no'>y2</span>,<span class='no'>y3</span>)
<span class='no'>dat</span>$<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='fl'>NA</span>

<span class='co'>#******************************************</span>
<span class='co'># Model 1: ML approach</span>

<span class='co'>#--- define model</span>
<span class='no'>nodes</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='fl'>21</span>)
<span class='no'>ind_y1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>y1</span> ~  <span class='fu'><a href='https://rdrr.io/r/stats/offset.html'>offset</a></span>(<span class='fl'>1</span>*<span class='no'>theta</span>),
                <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span> )
<span class='no'>ind_y2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>y2</span> ~ <span class='no'>theta</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span>,
                <span class='st'>"coef_inits"</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>,<span class='fl'>1</span>) )
<span class='no'>ind_y3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>y3</span> ~ <span class='no'>theta</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span>,
                 <span class='st'>"coef_inits"</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>) )
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>theta</span> ~ <span class='fl'>0</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span> )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"y1"</span><span class='kw'>=</span><span class='no'>ind_y1</span>,  <span class='st'>"y2"</span><span class='kw'>=</span><span class='no'>ind_y2</span>, <span class='st'>"y3"</span><span class='kw'>=</span><span class='no'>ind_y3</span>)

<span class='co'>#*** estimate model with mdmb::frm_em</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_em</span>(<span class='no'>dat</span>, <span class='no'>dep</span>, <span class='no'>ind</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#*** estimate model in lavaan</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>lavaan</span>)
<span class='no'>lavmodel</span> <span class='kw'>&lt;-</span> <span class='st'>"
     theta=~ 1*y1 + y2 + y3
     theta ~~ theta
     "</span>
<span class='no'>mod1b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>lavaan</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/cfa.html'>cfa</a></span>( <span class='kw'>model</span><span class='kw'>=</span><span class='no'>lavmodel</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1b</span>)

<span class='co'># compare likelihood</span>
<span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span>(<span class='no'>mod1</span>)
<span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span>(<span class='no'>mod1b</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 4: Rasch model</span>
<span class='co'>#############################################################################</span>

<span class='co'>#--- simulate data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>91834</span>)
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>500</span>
<span class='co'># latent variable</span>
<span class='no'>theta0</span> <span class='kw'>&lt;-</span> <span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>)
<span class='co'># number of items</span>
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>7</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sirt/man/sim.raschtype.html'>sim.raschtype</a></span>( <span class='no'>theta</span>, <span class='kw'>b</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>1.5</span>,<span class='fl'>1.5</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='no'>I</span>) )
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"I"</span>,<span class='fl'>1</span>:<span class='no'>I</span>)
<span class='no'>dat</span>$<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='fl'>NA</span>

<span class='co'>#******************************************</span>
<span class='co'># Model 1: ML approach</span>

<span class='co'>#--- define model</span>
<span class='no'>nodes</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='fl'>13</span>)
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>theta</span> ~  <span class='fl'>0</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span> )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>()
<span class='kw'>for</span> (<span class='no'>ii</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>I</span>){
    <span class='no'>ind_ii</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"logistic"</span>, <span class='kw'>formula</span><span class='kw'>=</span>
                 <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/formula.html'>as.formula</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"I"</span>,<span class='no'>ii</span>, <span class='st'>" ~ offset(1*theta)"</span>) ) )
    <span class='no'>ind</span><span class='kw'>[[</span><span class='no'>ii</span>]] <span class='kw'>&lt;-</span> <span class='no'>ind_ii</span>
}
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>ind</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>)[-(<span class='no'>I</span>+<span class='fl'>1</span>)]

<span class='co'>#--- estimate Rasch model with mdmb::frm_em</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_em</span>(<span class='no'>dat</span>, <span class='no'>dep</span>, <span class='no'>ind</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#--- estmate Rasch model with sirt package</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>sirt</span>)
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sirt/man/rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat</span>[,-(<span class='no'>I</span>+<span class='fl'>1</span>)], <span class='kw'>theta.k</span><span class='kw'>=</span><span class='no'>nodes</span>, <span class='kw'>use.freqpatt</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'>#** compare estimated parameters</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>mod1</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='no'>mod2</span>$<span class='no'>sd.trait</span>, -<span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>thresh</span>[ <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='no'>I</span>,<span class='fl'>1</span>)] ) ), <span class='fl'>3</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 5: Regression model with measurement error in covariates</span>
<span class='co'>#############################################################################</span>

<span class='co'>#--- simulate data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>768</span>)
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>1000</span>
<span class='co'># true score</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>)
<span class='co'># heterogeneous error variance</span>
<span class='no'>var_err</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>N</span>, <span class='fl'>.5</span>, <span class='fl'>1</span>)
<span class='co'># simulate observed score</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='no'>theta</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>var_err</span>) )
<span class='co'># simulate outcome</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fl'>.3</span> + <span class='fl'>.7</span> * <span class='no'>theta</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>.8</span> )
<span class='no'>dat0</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='kw'>y</span><span class='kw'>=</span><span class='no'>y</span>, <span class='kw'>x</span><span class='kw'>=</span><span class='no'>x</span>, <span class='kw'>theta</span><span class='kw'>=</span><span class='no'>theta</span> )

<span class='co'>#*** estimate model with true scores (which are unobserved in real datasets)</span>
<span class='no'>mod0</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>( <span class='no'>y</span> ~ <span class='no'>theta</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat0</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod0</span>)

<span class='co'>#******************************************</span>
<span class='co'># Model 1: Model-based approach</span>

<span class='co'>#--- specify model</span>
<span class='no'>dat</span>$<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='no'>nodes</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='fl'>15</span>)
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>y</span> ~ <span class='no'>theta</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span>,
                <span class='st'>"coef_inits"</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>, <span class='fl'>.4</span> ) )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>()
<span class='no'>ind</span><span class='kw'>[[</span><span class='st'>"theta"</span>]] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>theta</span> ~ <span class='fl'>1</span>,
                         <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span>  )
<span class='no'>ind</span><span class='kw'>[[</span><span class='st'>"x"</span>]] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>x</span> ~ <span class='fl'>0</span> + <span class='fu'><a href='https://rdrr.io/r/stats/offset.html'>offset</a></span>(<span class='no'>theta</span>),
                        <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span> )
<span class='co'># assumption of heterogeneous known error variance</span>
<span class='no'>ind</span><span class='kw'>[[</span><span class='st'>"x"</span>]]$<span class='no'>sigma_fixed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( <span class='no'>var_err</span> )

<span class='co'>#--- estimate regression model</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_em</span>(<span class='no'>dat</span>, <span class='no'>dep</span>, <span class='no'>ind</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#******************************************</span>
<span class='co'># Model 2: Fully Bayesian estimation</span>

<span class='co'>#--- specify model</span>
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>y</span> ~ <span class='no'>theta</span> )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>()
<span class='no'>ind</span><span class='kw'>[[</span><span class='st'>"theta"</span>]] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>theta</span> ~ <span class='fl'>1</span>  )
<span class='no'>ind</span><span class='kw'>[[</span><span class='st'>"x"</span>]] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>x</span> ~ <span class='fl'>0</span> + <span class='fu'><a href='https://rdrr.io/r/stats/offset.html'>offset</a></span>(<span class='no'>theta</span>) )
<span class='co'># assumption of heterogeneous known error variance</span>
<span class='no'>ind</span><span class='kw'>[[</span><span class='st'>"x"</span>]]$<span class='no'>sigma_fixed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( <span class='no'>var_err</span> )
<span class='no'>data_init</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>
<span class='no'>data_init</span>$<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>$<span class='no'>x</span>

<span class='co'># estimate model</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_fb</span>(<span class='no'>dat</span>, <span class='no'>dep</span>, <span class='no'>ind</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>200</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>data_init</span><span class='kw'>=</span><span class='no'>data_init</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod2</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 6: Non-normally distributed covariates:</span>
<span class='co'>#            Positive values with Box-Cox transformation</span>
<span class='co'>#############################################################################</span>

<span class='co'># simulate data with chi-squared distributed covariate from</span>
<span class='co'># regression model Y ~ X</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>876</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>1500</span>
<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>rchisq</a></span>( <span class='no'>n</span>, <span class='kw'>df</span><span class='kw'>=</span><span class='no'>df</span> )
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='no'>x</span> / <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( <span class='fl'>2</span>*<span class='no'>df</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fl'>0</span> + <span class='fl'>1</span>*<span class='no'>x</span>
<span class='no'>R2</span> <span class='kw'>&lt;-</span> <span class='fl'>.25</span>    <span class='co'># explained variance</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>y</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( (<span class='fl'>1</span>-<span class='no'>R2</span>)/<span class='no'>R2</span> * <span class='fl'>1</span>) )
<span class='no'>dat0</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='kw'>y</span><span class='kw'>=</span><span class='no'>y</span>, <span class='kw'>x</span><span class='kw'>=</span><span class='no'>x</span> )

<span class='co'># simulate missing responses</span>
<span class='no'>prop_miss</span> <span class='kw'>&lt;-</span> <span class='fl'>.5</span>
<span class='no'>cor_miss</span> <span class='kw'>&lt;-</span> <span class='fl'>.7</span>
<span class='no'>resp_tend</span> <span class='kw'>&lt;-</span> <span class='no'>cor_miss</span>*(<span class='no'>dat</span>$<span class='no'>y</span>-<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>y</span>) )/ <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span>(<span class='no'>y</span>) +
                 <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( <span class='fl'>1</span> - <span class='no'>cor_miss</span>^<span class='fl'>2</span>) )
<span class='no'>dat</span>[ <span class='no'>resp_tend</span> <span class='kw'>&lt;</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span>( <span class='no'>prop_miss</span> ), <span class='st'>"x"</span> ] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>dat</span>)

<span class='co'>#-- complete data</span>
<span class='no'>mod0</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>( <span class='no'>y</span> ~ <span class='no'>x</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat0</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod0</span>)
<span class='co'>#-- listwise deletion</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>( <span class='no'>y</span> ~ <span class='no'>x</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'># normal distribution assumption for frm</span>

<span class='co'># define models</span>
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>y</span> ~  <span class='no'>x</span> )
<span class='co'># normally distributed data</span>
<span class='no'>ind_x1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>x</span> ~ <span class='fl'>1</span> )
<span class='co'># Box-Cox normal distribution</span>
<span class='no'>ind_x2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"bctreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>x</span> ~ <span class='fl'>1</span>,
              <span class='kw'>nodes</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0.05</span>, <span class='fl'>3</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='fl'>31</span>), <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>( <span class='fl'>3.5</span>, <span class='fl'>9</span>, <span class='kw'>by</span><span class='kw'>=</span><span class='fl'>.5</span> ) ) )
<span class='no'>ind1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"x"</span><span class='kw'>=</span><span class='no'>ind_x1</span> )
<span class='no'>ind2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"x"</span><span class='kw'>=</span><span class='no'>ind_x2</span> )

<span class='co'>#--- incorrect normal distribution assumption</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_em</span>(<span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>dep</span><span class='kw'>=</span><span class='no'>dep</span>, <span class='kw'>ind</span><span class='kw'>=</span><span class='no'>ind1</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#--- model chi-square distribution of predictor with Box-Cox transformation</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_em</span>(<span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>dep</span><span class='kw'>=</span><span class='no'>dep</span>, <span class='kw'>ind</span><span class='kw'>=</span><span class='no'>ind2</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 7: Latent interaction model</span>
<span class='co'>#############################################################################</span>

<span class='co'># A latent interaction model Y ~ FX + FZ is of interest. Y is directly observed,</span>
<span class='co'># FX and FZ are both indirectly observed by three items</span>

<span class='co'>#--- simulate data</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>1000</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>987</span>)
<span class='co'># latent variable</span>
<span class='no'>FX</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>)
<span class='no'>FZ</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>)
<span class='co'># simulate items</span>
<span class='no'>x1</span> <span class='kw'>&lt;-</span> <span class='fl'>1.5</span> + <span class='fl'>1</span>*<span class='no'>FX</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>.7</span> )
<span class='no'>x2</span> <span class='kw'>&lt;-</span> <span class='fl'>1.9</span> + <span class='fl'>.7</span>*<span class='no'>FX</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span> )
<span class='no'>x3</span> <span class='kw'>&lt;-</span> <span class='fl'>.9</span> + <span class='fl'>.7</span>*<span class='no'>FX</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>.2</span> )
<span class='no'>z1</span> <span class='kw'>&lt;-</span> <span class='fl'>1.5</span> + <span class='fl'>1</span>*<span class='no'>FZ</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>.7</span> )
<span class='no'>z2</span> <span class='kw'>&lt;-</span> <span class='fl'>1.9</span> + <span class='fl'>.7</span>*<span class='no'>FZ</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span> )
<span class='no'>z3</span> <span class='kw'>&lt;-</span> <span class='fl'>.9</span> + <span class='fl'>.7</span>*<span class='no'>FZ</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>.2</span> )
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='no'>x1</span>,<span class='no'>x2</span>,<span class='no'>x3</span>,<span class='no'>z1</span>,<span class='no'>z2</span>,<span class='no'>z3</span>)
<span class='no'>dat</span>$<span class='no'>FX</span> <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='no'>dat</span>$<span class='no'>FZ</span> <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='no'>dat</span>$<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span> + <span class='fl'>.5</span>*<span class='no'>FX</span> + <span class='fl'>.3</span>*<span class='no'>FZ</span> + <span class='fl'>.4</span>*<span class='no'>FX</span>*<span class='no'>FZ</span> + <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span> )

<span class='co'># estimate interaction model with ML</span>

<span class='co'>#--- define model</span>
<span class='no'>nodes</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='fl'>11</span>)
<span class='no'>ind_x1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>x1</span> ~  <span class='fu'><a href='https://rdrr.io/r/stats/offset.html'>offset</a></span>(<span class='fl'>1</span>*<span class='no'>FX</span>),
                <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span> )
<span class='no'>ind_x2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>x2</span> ~ <span class='no'>FX</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span>,
                <span class='st'>"coef_inits"</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>,<span class='fl'>1</span>) )
<span class='no'>ind_x3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>x3</span> ~ <span class='no'>FX</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span>,
                 <span class='st'>"coef_inits"</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>) )
<span class='no'>ind_FX</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>FX</span> ~ <span class='fl'>0</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span> )
<span class='no'>ind_z1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>z1</span> ~  <span class='fu'><a href='https://rdrr.io/r/stats/offset.html'>offset</a></span>(<span class='fl'>1</span>*<span class='no'>FZ</span>),
                <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span> )
<span class='no'>ind_z2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>z2</span> ~ <span class='no'>FZ</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span>,
                <span class='st'>"coef_inits"</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>,<span class='fl'>1</span>) )
<span class='no'>ind_z3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>z3</span> ~ <span class='no'>FZ</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span>,
                 <span class='st'>"coef_inits"</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>) )
<span class='no'>ind_FZ</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>FZ</span> ~ <span class='fl'>0</span> + <span class='no'>FX</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span> )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"x1"</span><span class='kw'>=</span><span class='no'>ind_x1</span>,  <span class='st'>"x2"</span><span class='kw'>=</span><span class='no'>ind_x2</span>, <span class='st'>"x3"</span><span class='kw'>=</span><span class='no'>ind_x3</span>, <span class='st'>"FX"</span><span class='kw'>=</span><span class='no'>ind_FX</span>,
            <span class='st'>"z1"</span><span class='kw'>=</span><span class='no'>ind_z1</span>,  <span class='st'>"z2"</span><span class='kw'>=</span><span class='no'>ind_z2</span>, <span class='st'>"z3"</span><span class='kw'>=</span><span class='no'>ind_z3</span>, <span class='st'>"FX"</span><span class='kw'>=</span><span class='no'>ind_FZ</span> )
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='kw'>formula</span><span class='kw'>=</span><span class='no'>y</span> ~ <span class='no'>FX</span>+<span class='no'>FZ</span>+<span class='no'>FX</span>*<span class='no'>FZ</span>, <span class='st'>"coef_inits"</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>.2</span>,<span class='fl'>.2</span>,<span class='fl'>0</span>) )

<span class='co'>#*** estimate model with mdmb::frm_em</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_em</span>(<span class='no'>dat</span>, <span class='no'>dep</span>, <span class='no'>ind</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 8: Non-ignorable data in Y</span>
<span class='co'>#############################################################################</span>

<span class='co'># regression Y ~ X in which Y is missing depending Y itself</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>mvtnorm</span>)
<span class='no'>cor_XY</span> <span class='kw'>&lt;-</span> <span class='fl'>.4</span>        <span class='co'># correlation between X and Y</span>
<span class='no'>prop_miss</span> <span class='kw'>&lt;-</span> <span class='fl'>.5</span>     <span class='co'># missing proportion</span>
<span class='no'>cor_missY</span> <span class='kw'>&lt;-</span> <span class='fl'>.7</span>     <span class='co'># correlation with missing propensity</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>3000</span>           <span class='co'># sample size</span>

<span class='co'>#----- simulate data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>790</span>)
<span class='no'>Sigma</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='no'>cor_XY</span>, <span class='no'>cor_XY</span>, <span class='fl'>1</span>), <span class='fl'>2</span>, <span class='fl'>2</span> )
<span class='no'>mu</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mvtnorm</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span>( <span class='no'>N</span>, <span class='kw'>mean</span><span class='kw'>=</span><span class='no'>mu</span>, <span class='kw'>sigma</span><span class='kw'>=</span><span class='no'>Sigma</span> )
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"X"</span>,<span class='st'>"Y"</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span>(<span class='no'>dat</span>)

<span class='co'>#-- generate missing responses on Y depending on Y itself</span>
<span class='no'>y1</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>$<span class='no'>Y</span>
<span class='no'>miss_tend</span> <span class='kw'>&lt;-</span> <span class='no'>cor_missY</span> * <span class='no'>y1</span>  + <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( <span class='fl'>1</span> - <span class='no'>cor_missY</span>^<span class='fl'>2</span>) )
<span class='no'>dat</span>$<span class='no'>Y</span>[ <span class='no'>miss_tend</span> <span class='kw'>&lt;</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>( <span class='no'>miss_tend</span>, <span class='no'>prop_miss</span> ) ] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>

<span class='co'>#--- ML estimation under assumption of ignorability</span>
<span class='no'>nodes</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='fl'>15</span>)
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>Y</span> ~  <span class='no'>X</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span> )
<span class='no'>ind_X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>X</span> ~ <span class='fl'>1</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span> )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"X"</span><span class='kw'>=</span><span class='no'>ind_X</span> )
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_em</span>(<span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>dep</span><span class='kw'>=</span><span class='no'>dep</span>, <span class='kw'>ind</span><span class='kw'>=</span><span class='no'>ind</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#--- ML estimation under assumption with specifying a model for non-ignorability</span>
<span class='co'>#    for response indicator resp_Y</span>
<span class='no'>dat</span>$<span class='no'>resp_Y</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>* ( <span class='fl'>1</span> - <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>dat</span>$<span class='no'>Y</span>) )
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>Y</span> ~  <span class='no'>X</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span> )
<span class='no'>ind_X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>X</span> ~ <span class='fl'>1</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span> )
<span class='no'>ind_respY</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"logistic"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>resp_Y</span> ~ <span class='no'>Y</span>, <span class='st'>"nodes"</span><span class='kw'>=</span><span class='no'>nodes</span> )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"X"</span><span class='kw'>=</span><span class='no'>ind_X</span>, <span class='st'>"resp_Y"</span><span class='kw'>=</span><span class='no'>ind_respY</span> )
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_em</span>(<span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>dep</span><span class='kw'>=</span><span class='no'>dep</span>, <span class='kw'>ind</span><span class='kw'>=</span><span class='no'>ind</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 9: Ordinal variables: Graded response model</span>
<span class='co'>#############################################################################</span>

<span class='co'>#--- simulate data</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>2000</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>91834</span>)
<span class='co'># latent variable</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>)
<span class='co'># simulate items</span>
<span class='no'>y1</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>*<span class='no'>theta</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>)
<span class='no'>y2</span> <span class='kw'>&lt;-</span> <span class='fl'>.7</span>*<span class='no'>theta</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>)
<span class='no'>y3</span> <span class='kw'>&lt;-</span> <span class='fl'>.7</span>*<span class='no'>theta</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>)
<span class='co'># discretize variables</span>
<span class='no'>y1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span>( <span class='no'>y1</span>, <span class='kw'>breaks</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>Inf</span>, -<span class='fl'>.5</span>, <span class='fl'>0.4</span>, <span class='fl'>1</span>, <span class='fl'>Inf</span> ) ) ) - <span class='fl'>1</span>
<span class='no'>y2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span>( <span class='no'>y2</span>, <span class='kw'>breaks</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>Inf</span>, <span class='fl'>0.3</span>, <span class='fl'>1</span>, <span class='fl'>Inf</span> ) ) ) - <span class='fl'>1</span>
<span class='no'>y3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span>( <span class='no'>y3</span>, <span class='kw'>breaks</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>Inf</span>, <span class='fl'>.2</span>, <span class='fl'>Inf</span> ) ) ) - <span class='fl'>1</span>
<span class='co'># define dataset</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='no'>y1</span>,<span class='no'>y2</span>,<span class='no'>y3</span>)
<span class='no'>dat</span>$<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='fl'>NA</span>

<span class='co'>#******************************************</span>
<span class='co'># Model 1: Fully Bayesian estimation</span>

<span class='co'>#--- define model</span>
<span class='no'>ind_y1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"oprobit"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>y1</span> ~  <span class='fu'><a href='https://rdrr.io/r/stats/offset.html'>offset</a></span>(<span class='fl'>1</span>*<span class='no'>theta</span>) )
<span class='no'>ind_y2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"oprobit"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>y2</span> ~ <span class='no'>theta</span> )
<span class='no'>ind_y3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"oprobit"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>y3</span> ~ <span class='no'>theta</span> )
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>theta</span> ~ <span class='fl'>0</span>  )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"y1"</span><span class='kw'>=</span><span class='no'>ind_y1</span>,  <span class='st'>"y2"</span><span class='kw'>=</span><span class='no'>ind_y2</span>, <span class='st'>"y3"</span><span class='kw'>=</span><span class='no'>ind_y3</span>)
<span class='co'># initial data</span>
<span class='no'>data_init</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>
<span class='no'>data_init</span>$<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span>(<span class='no'>dat</span>$<span class='no'>y1</span>) ) + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>.4</span> )

<span class='co'>#-- estimate model</span>
<span class='no'>iter</span> <span class='kw'>&lt;-</span> <span class='fl'>3000</span>; <span class='no'>burnin</span> <span class='kw'>&lt;-</span> <span class='fl'>1000</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_fb</span>(<span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>dep</span><span class='kw'>=</span><span class='no'>dep</span>, <span class='kw'>ind</span><span class='kw'>=</span><span class='no'>ind</span>, <span class='kw'>data_init</span><span class='kw'>=</span><span class='no'>data_init</span>,
                   <span class='kw'>iter</span><span class='kw'>=</span><span class='no'>iter</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='no'>burnin</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod1</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 10: Imputation for missig predictors in models with interaction</span>
<span class='co'>#             effects in multilevel regression models</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>miceadds</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.mb04</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"mdmb"</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.mb04</span>

<span class='co'>#*** model specification</span>
<span class='no'>mcmc_iter</span> <span class='kw'>&lt;-</span> <span class='fl'>4</span>   <span class='co'># number of MCMC iterations for model parameter sampling</span>
<span class='no'>model_formula</span> <span class='kw'>&lt;-</span> <span class='no'>y</span> ~ <span class='fu'><a href='https://rdrr.io/pkg/miceadds/man/GroupMean.html'>cwc</a></span>(<span class='no'>x</span>, <span class='no'>idcluster</span>) + <span class='fu'><a href='https://rdrr.io/pkg/miceadds/man/GroupMean.html'>gm</a></span>(<span class='no'>x</span>, <span class='no'>idcluster</span>) + <span class='no'>w</span> + <span class='no'>w</span>*<span class='fu'><a href='https://rdrr.io/pkg/miceadds/man/GroupMean.html'>cwc</a></span>(<span class='no'>x</span>, <span class='no'>idcluster</span>) +
                   <span class='no'>w</span>*<span class='fu'><a href='https://rdrr.io/pkg/miceadds/man/GroupMean.html'>gm</a></span>(<span class='no'>x</span>, <span class='no'>idcluster</span>) + ( <span class='fl'>1</span> + <span class='fu'><a href='https://rdrr.io/pkg/miceadds/man/GroupMean.html'>cwc</a></span>(<span class='no'>x</span>, <span class='no'>idcluster</span>) <span class='kw'>|</span> <span class='no'>idcluster</span>)
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"mlreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>model_formula</span>,
               <span class='kw'>R_args</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>iter</span><span class='kw'>=</span><span class='no'>mcmc_iter</span>, <span class='kw'>outcome</span><span class='kw'>=</span><span class='st'>"normal"</span>) )
<span class='no'>ind_x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"mlreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>x</span> ~ <span class='no'>w</span> + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>idcluster</span>), <span class='kw'>R_args</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>iter</span><span class='kw'>=</span><span class='no'>mcmc_iter</span>),
                  <span class='kw'>sampling_level</span><span class='kw'>=</span><span class='st'>"idcluster"</span> )
<span class='co'># group means of x are involved in the outcome model. Therefore, Metropolis-Hastings</span>
<span class='co'># sampling of missing values in x should be conducted at the level of clusters,</span>
<span class='co'># i.e. specifying sampling_level</span>
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"x"</span><span class='kw'>=</span><span class='no'>ind_x</span>)

<span class='co'># --- estimate model</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_fb</span>(<span class='no'>dat</span>, <span class='no'>dep</span>, <span class='no'>ind</span>, <span class='kw'>aggregation</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='co'># argument aggregation is necessary because group means are involved in regression formulas</span>

<span class='co'>#-------------</span>
<span class='co'>#*** imputation of a continuous level-2 variable w</span>

<span class='co'>#  create artificially some missings on w</span>
<span class='no'>dat</span>[ <span class='no'>dat</span>$<span class='no'>idcluster</span> <span class='kw'>%%</span><span class='fl'>3</span><span class='kw'>==</span><span class='fl'>0</span>, <span class='st'>"w"</span> ] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>

<span class='co'># define level-2 model with argument variable_level</span>
<span class='no'>ind_w</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>w</span> ~ <span class='fl'>1</span>, <span class='st'>"variable_level"</span><span class='kw'>=</span><span class='st'>"idcluster"</span> )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='kw'>x</span><span class='kw'>=</span><span class='no'>ind_x</span>, <span class='kw'>w</span><span class='kw'>=</span><span class='no'>ind_w</span>)

<span class='co'>#* conduct imputations</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_fb</span>(<span class='no'>dat</span>, <span class='no'>dep</span>, <span class='no'>ind</span>, <span class='kw'>aggregation</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'>#--- Model 1 with user-defined prior distributions for covariance matrices</span>
<span class='no'>model_formula</span> <span class='kw'>&lt;-</span> <span class='no'>y</span> ~ <span class='fu'><a href='https://rdrr.io/pkg/miceadds/man/GroupMean.html'>cwc</a></span>(<span class='no'>x</span>, <span class='no'>idcluster</span>) + <span class='fu'><a href='https://rdrr.io/pkg/miceadds/man/GroupMean.html'>gm</a></span>(<span class='no'>x</span>, <span class='no'>idcluster</span>) + <span class='no'>w</span> + <span class='no'>w</span>*<span class='fu'><a href='https://rdrr.io/pkg/miceadds/man/GroupMean.html'>cwc</a></span>(<span class='no'>x</span>, <span class='no'>idcluster</span>) +
                   <span class='no'>w</span>*<span class='fu'><a href='https://rdrr.io/pkg/miceadds/man/GroupMean.html'>gm</a></span>(<span class='no'>x</span>, <span class='no'>idcluster</span>) + ( <span class='fl'>1</span> + <span class='fu'><a href='https://rdrr.io/pkg/miceadds/man/GroupMean.html'>cwc</a></span>(<span class='no'>x</span>, <span class='no'>idcluster</span>) <span class='kw'>|</span> <span class='no'>idcluster</span>)

<span class='co'># define scale degrees of freedom (nu) and scale matrix (S) for inverse Wishart distribution</span>
<span class='no'>psi_nu0_list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( -<span class='fl'>3</span> )
<span class='no'>psi_S0_list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fl'>0</span>,<span class='fl'>2</span>) )
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"mlreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>model_formula</span>,
               <span class='kw'>R_args</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>iter</span><span class='kw'>=</span><span class='no'>mcmc_iter</span>, <span class='kw'>outcome</span><span class='kw'>=</span><span class='st'>"normal"</span>,
               <span class='kw'>psi_nu0_list</span><span class='kw'>=</span><span class='no'>psi_nu0_list</span>, <span class='kw'>psi_S0_list</span><span class='kw'>=</span><span class='no'>psi_S0_list</span> ) )

<span class='co'># define nu and S parameters for covariate model</span>
<span class='no'>psi_nu0_list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='fl'>.4</span> )
<span class='no'>psi_S0_list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>.2</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>) )
<span class='no'>ind_x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"mlreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>x</span> ~ <span class='no'>w</span> + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>idcluster</span>),
                   <span class='kw'>R_args</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>iter</span><span class='kw'>=</span><span class='no'>mcmc_iter</span>, <span class='kw'>psi_nu0_list</span><span class='kw'>=</span><span class='no'>psi_nu0_list</span>,
                            <span class='kw'>psi_S0_list</span><span class='kw'>=</span><span class='no'>psi_S0_list</span>),
                  <span class='kw'>sampling_level</span><span class='kw'>=</span><span class='st'>"idcluster"</span> )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"x"</span><span class='kw'>=</span><span class='no'>ind_x</span>)

<span class='co'># --- estimate model</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_fb</span>(<span class='no'>dat</span>, <span class='no'>dep</span>, <span class='no'>ind</span>, <span class='kw'>aggregation</span><span class='kw'>=</span><span class='fl'>TRUE</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 11: Bounded variable combined with Yeo-Johnson transformation</span>
<span class='co'>#############################################################################</span>

<span class='co'>#*** simulate data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>876</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>1500</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'><a href='yjt_dist.html'>ryjt_scaled</a></span>( <span class='no'>n</span>, <span class='kw'>location</span><span class='kw'>=</span>-<span class='fl'>.2</span>, <span class='kw'>shape</span><span class='kw'>=</span><span class='fl'>.8</span>, <span class='kw'>lambda</span><span class='kw'>=</span><span class='fl'>.9</span>, <span class='kw'>probit</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>R2</span> <span class='kw'>&lt;-</span> <span class='fl'>.25</span>    <span class='co'># explained variance</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>*<span class='no'>x</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( (<span class='fl'>1</span>-<span class='no'>R2</span>)/<span class='no'>R2</span> * <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span>(<span class='no'>x</span>)) )
<span class='no'>dat0</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='kw'>y</span><span class='kw'>=</span><span class='no'>y</span>, <span class='kw'>x</span><span class='kw'>=</span><span class='no'>x</span> )

<span class='co'># simulate missing responses</span>
<span class='no'>prop_miss</span> <span class='kw'>&lt;-</span> <span class='fl'>.5</span>
<span class='no'>cor_miss</span> <span class='kw'>&lt;-</span> <span class='fl'>.7</span>
<span class='no'>resp_tend</span> <span class='kw'>&lt;-</span> <span class='no'>cor_miss</span>*(<span class='no'>dat</span>$<span class='no'>y</span>-<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>y</span>) )/ <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span>(<span class='no'>y</span>) +
                 <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( <span class='fl'>1</span> - <span class='no'>cor_miss</span>^<span class='fl'>2</span>) )
<span class='no'>dat</span>[ <span class='no'>resp_tend</span> <span class='kw'>&lt;</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span>(<span class='no'>prop_miss</span>), <span class='st'>"x"</span> ] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>dat</span>)

<span class='co'>#*** define models</span>
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>y</span> ~  <span class='no'>x</span> )
<span class='co'># distribution according to Yeo-Johnson transformation</span>
<span class='no'>ind_x1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"yjtreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>x</span> ~ <span class='fl'>1</span> )
<span class='co'># distribution according to Probit Yeo-Johnson transformation</span>
<span class='no'>ind_x2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"yjtreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>x</span> ~ <span class='fl'>1</span>, <span class='kw'>R_args</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"probit"</span><span class='kw'>=</span><span class='fl'>TRUE</span> ) )
<span class='no'>ind1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"x"</span><span class='kw'>=</span><span class='no'>ind_x1</span> )
<span class='no'>ind2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"x"</span><span class='kw'>=</span><span class='no'>ind_x2</span> )

<span class='co'>#--- complete data</span>
<span class='no'>mod0</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>( <span class='no'>y</span>~<span class='no'>x</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat0</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod0</span>)

<span class='co'>#--- Yeo-Johnson normal distribution (for unbounded variables)</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_em</span>(<span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>dep</span><span class='kw'>=</span><span class='no'>dep</span>, <span class='kw'>ind</span><span class='kw'>=</span><span class='no'>ind1</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#--- Probit Yeo-Johnson normal distribution (for bounded variable on (0,1))</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_em</span>(<span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>dep</span><span class='kw'>=</span><span class='no'>dep</span>, <span class='kw'>ind</span><span class='kw'>=</span><span class='no'>ind2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'>#--- same model, but MCMC estimation</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_fb</span>(<span class='no'>dat</span>, <span class='no'>dep</span>, <span class='kw'>ind</span><span class='kw'>=</span><span class='no'>ind2</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>2000</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='fl'>5000</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod3</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 12: Yeo-Johnson transformation with estimated degrees of freedom</span>
<span class='co'>#############################################################################</span>

<span class='co'>#*** simulate data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>876</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>1500</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'><a href='yjt_dist.html'>ryjt_scaled</a></span>( <span class='no'>n</span>, <span class='kw'>location</span><span class='kw'>=</span>-<span class='fl'>.2</span>, <span class='kw'>shape</span><span class='kw'>=</span><span class='fl'>.8</span>, <span class='kw'>lambda</span><span class='kw'>=</span><span class='fl'>.9</span>, <span class='kw'>df</span><span class='kw'>=</span><span class='fl'>10</span> )
<span class='no'>R2</span> <span class='kw'>&lt;-</span> <span class='fl'>.25</span>    <span class='co'># explained variance</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>*<span class='no'>x</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( (<span class='fl'>1</span>-<span class='no'>R2</span>)/<span class='no'>R2</span> * <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span>(<span class='no'>x</span>)) )
<span class='no'>dat0</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='kw'>y</span><span class='kw'>=</span><span class='no'>y</span>, <span class='kw'>x</span><span class='kw'>=</span><span class='no'>x</span> )

<span class='co'># simulate missing responses</span>
<span class='no'>prop_miss</span> <span class='kw'>&lt;-</span> <span class='fl'>.5</span>
<span class='no'>cor_miss</span> <span class='kw'>&lt;-</span> <span class='fl'>.7</span>
<span class='no'>resp_tend</span> <span class='kw'>&lt;-</span> <span class='no'>cor_miss</span>*(<span class='no'>dat</span>$<span class='no'>y</span>-<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>y</span>) )/ <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span>(<span class='no'>y</span>) +
                 <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( <span class='fl'>1</span>-<span class='no'>cor_miss</span>^<span class='fl'>2</span>) )
<span class='no'>dat</span>[ <span class='no'>resp_tend</span> <span class='kw'>&lt;</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span>(<span class='no'>prop_miss</span>), <span class='st'>"x"</span> ] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>dat</span>)

<span class='co'>#*** define models</span>
<span class='no'>dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"linreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>y</span> ~  <span class='no'>x</span> )
<span class='co'># specify distribution with estimated degrees of freedom</span>
<span class='no'>ind_x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"model"</span><span class='kw'>=</span><span class='st'>"yjtreg"</span>, <span class='st'>"formula"</span><span class='kw'>=</span><span class='no'>x</span> ~ <span class='fl'>1</span>, <span class='kw'>R_args</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>est_df</span><span class='kw'>=</span><span class='fl'>TRUE</span> ) )
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"x"</span><span class='kw'>=</span><span class='no'>ind_x</span> )

<span class='co'>#--- Yeo-Johnson t distribution</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mdmb</span><span class='kw ns'>::</span><span class='fu'>frm_fb</span>(<span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>dep</span><span class='kw'>=</span><span class='no'>dep</span>, <span class='kw'>ind</span><span class='kw'>=</span><span class='no'>ind</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='fl'>3000</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>1000</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


